/**
 *	jQuery MG Gallery Plugin
 *
 *	Version 1.3.0
 *
 * Copyright (c) 2011 - 2012 Wolfgang Moritz (http://www.wolfmoritz.com)
 * Licensed under the MIT License:
 *   http://www.opensource.org/licenses/mit-license.php
 */
(function(b){var a={},d;b.fn.mggallery=function(c){b.extend(a,b.fn.mggallery.defaults,c);a.gallery={priorIndex:0,currentIndex:0,currentHash:"1",thumbnailCount:0,thumbnailPagePriorIndex:0,thumbnailPageIndex:0,thumbnailTotalPages:0,slideShowIntervalId:0};d=this.children("ul").children("li");a.gallery.thumbnailCount=d.size();0<a.gallery.thumbnailCount&&(b.fn.mggallery.methods.init(this),b.fn.mggallery.methods.preloadImages());return this};b.fn.mggallery.methods={initGalleryContainer:function(){var c; c='<div class="next" style="opacity: 0;">'+('<div class="'+a.currentImageDivClass.replace(".","")+'"><img src="" /></div>');c+='<div class="'+a.currentTitleDivClass.replace(".","")+'"></div>';c+='<div class="'+a.currentMetaDivClass.replace(".","")+'"></div></div>';b("div"+a.mainImageDivContainerId).html(c).prepend('<div class="slideShowControls" />');0<a.slideShowInterval&&b("div.slideShowControls").html('<span class="pause" title="'+a.slideShowPauseTitle+'">'+a.slideShowPause+'</span><span class="play" title="'+ a.slideShowPlayTitle+'">'+a.slideShowPlay+"</span>")},loadImage:function(c){c=b(c);var e=c.children("a").attr("href"),f=c.children("a").attr("title"),d=c.children("div"+a.thumbnailMetaDivClass).html();a.gallery.priorIndex=a.gallery.currentIndex;a.gallery.currentIndex=c.data("img_id");a.gallery.thumbnailPagePriorIndex=a.gallery.thumbnailPageIndex;a.gallery.thumbnailPageIndex=c.data("thumbpage");a.enableDeepLinks&&void 0!==e&&(a.gallery.currentHash=c.data("img_hash"),window.location.hash=b.fn.mggallery.methods.imagePath(e)); $next=b("div"+a.mainImageDivContainerId+">div.next");$next.children("div"+a.currentImageDivClass).children("img").load(function(){b.trim(f)?$next.children("div"+a.currentTitleDivClass).html(f).show():$next.children("div"+a.currentTitleDivClass).hide();b.trim(d)?$next.children("div"+a.currentMetaDivClass).html(d).show():$next.children("div"+a.currentMetaDivClass).hide()}).attr("src",e);b("li"+a.thumbnailCurrentItemClass).removeClass(a.thumbnailCurrentItemClass.replace(".",""));c.addClass(a.thumbnailCurrentItemClass.replace(".", ""))},getNextImage:function(){b.fn.mggallery.methods.exchangeImage(a.gallery.currentIndex+1<a.gallery.thumbnailCount?'li[data-img_id="'+(a.gallery.currentIndex+1)+'"]':'li[data-img_id="0"]')},fadeThumb:function(c,e){b(c).hasClass(a.thumbnailCurrentItemClass.replace(".",""))&&(e=1);b(c).children("a").children("img").stop().animate({opacity:e},a.animationSpeed)},exchangeImage:"",swapImage:function(c){b("div"+a.mainImageDivContainerId).find(":animated").stop(!0,!0);$current=b("div"+a.mainImageDivContainerId+ ">div.current").toggleClass("current next");$current.animate({opacity:0},a.animationSpeed,function(){b.fn.mggallery.methods.loadImage(c);b.fn.mggallery.methods.fadeThumb('li[data-img_id="'+a.gallery.priorIndex+'"]',a.thumbDefaultOpacity);a.gallery.thumbnailPagePriorIndex!==a.gallery.thumbnailPageIndex&&b.fn.mggallery.methods.swapThumbPage();b(this).toggleClass("next current");b.fn.mggallery.methods.fadeThumb(c,1)});$current.animate({opacity:1},a.animationSpeed)},crossfadeImage:function(c){b("div"+ a.mainImageDivContainerId).find(":animated").stop(!0,!0);$current=b("div"+a.mainImageDivContainerId+">div.current");$current.clone().css("opacity",0).toggleClass("current next").appendTo("div"+a.mainImageDivContainerId);b.fn.mggallery.methods.loadImage(c);b.fn.mggallery.methods.fadeThumb('li[data-img_id="'+a.gallery.priorIndex+'"]',a.thumbDefaultOpacity);a.gallery.thumbnailPagePriorIndex!==a.gallery.thumbnailPageIndex&&b.fn.mggallery.methods.swapThumbPage();b.fn.mggallery.methods.fadeThumb(c,1);$current.animate({opacity:0}, a.animationSpeed,function(){b(this).remove()});b("div"+a.mainImageDivContainerId+">div.next").animate({opacity:1},a.animationSpeed,function(){b(this).toggleClass("next current")})},imagePath:function(a){return a.replace(window.location.hostname,"").replace(window.location.protocol,"").replace("//","")},hashImagePath:function(a){return b.fn.mggallery.methods.imagePath(a).replace(/[^a-zA-Z0-9]/g,"")},preloadImages:function(){d.each(function(){b("<img/>")[0].src=b(this).children("a").attr("href")})}, initThumbPageControls:function(){var c='<span class="first" title="'+a.thumbNavFirstTitle+'">'+a.thumbNavFirst+"</span>",e='<span class="prev" title="'+a.thumbNavPrevTitle+'">'+a.thumbNavPrev+"</span>",f='<span class="next" title="'+a.thumbNavNextTitle+'">'+a.thumbNavNext+"</span>",d='<span class="last" title="'+a.thumbNavLastTitle+'">'+a.thumbNavLast+"</span>",g="",g=1===a.gallery.thumbnailPageIndex?f+d:a.gallery.thumbnailPageIndex===a.gallery.thumbnailTotalPages?c+e:c+e+f+d;b("div.thumbPageControls").html(g)}, swapThumbPage:function(){b("div#thumbPage_"+a.gallery.thumbnailPagePriorIndex).add("div.thumbPageControls").fadeOut(a.animationSpeed,function(){b.fn.mggallery.methods.initThumbPageControls();b("div#thumbPage_"+a.gallery.thumbnailPageIndex).add("div.thumbPageControls").fadeIn(a.animationSpeed)})},startSlideShow:function(){0===a.gallery.slideShowIntervalId&&(a.gallery.slideShowIntervalId=window.setInterval(function(){b.fn.mggallery.methods.getNextImage()},a.slideShowInterval))},stopSlideShow:function(){0!== a.gallery.slideShowIntervalId&&(window.clearInterval(a.gallery.slideShowIntervalId),a.gallery.slideShowIntervalId=0)},init:function(c){d.each(function(a){b(this).addClass("thumbItem").attr("data-img_id",a).attr("data-img_hash",b.fn.mggallery.methods.hashImagePath(b(this).children("a").attr("href")))});c.prepend('<div class="thumbPageControls" />');c.children("ul").append('<div class="clear" />');b.fn.mggallery.methods.initGalleryContainer();for(var e=0;e<a.gallery.thumbnailCount;)a.gallery.thumbnailTotalPages+= 1,d.slice(e,e+a.thumbPageLimit).wrapAll('<div id="thumbPage_'+a.gallery.thumbnailTotalPages+'" class="centerThumbs" style="display:none;"/>').attr("data-thumbpage",a.gallery.thumbnailTotalPages),e+=a.thumbPageLimit;0<b.fn.mggallery.methods.hashImagePath(window.location.hash).length&&void 0!==b.fn.mggallery.methods.hashImagePath(window.location.hash)?b.fn.mggallery.methods.loadImage('li[data-img_hash="'+b.fn.mggallery.methods.hashImagePath(window.location.hash)+'"]'):b.fn.mggallery.methods.loadImage(d[0]); "swap"===a.exchangeType?b.fn.mggallery.methods.exchangeImage=b.fn.mggallery.methods.swapImage:"crossfade"===a.exchangeType&&(b.fn.mggallery.methods.exchangeImage=b.fn.mggallery.methods.crossfadeImage);a.gallery.thumbnailCount>a.thumbPageLimit&&b.fn.mggallery.methods.initThumbPageControls();b(a.mainImageDivContainerId).on("click","img",function(a){a.preventDefault();b.fn.mggallery.methods.getNextImage()});c.delegate("li.thumbItem","click",function(c){c.preventDefault();b(this).data("img_id")!==a.gallery.currentIndex&& (b(this).addClass(a.thumbnailCurrentItemClass.replace(".","")),b.fn.mggallery.methods.exchangeImage(this))});d.each(function(){b(this).on({mouseenter:function(){b.fn.mggallery.methods.fadeThumb(this,1)},mouseleave:function(){b.fn.mggallery.methods.fadeThumb(this,a.thumbDefaultOpacity)}})});b(".thumbPageControls").on("click","span",function(c){c.preventDefault();a.gallery.thumbnailPagePriorIndex=a.gallery.thumbnailPageIndex;c=b(this).attr("class");"first"===c?a.gallery.thumbnailPageIndex=1:"prev"=== c?a.gallery.thumbnailPageIndex--:"next"===c?a.gallery.thumbnailPageIndex++:"last"===c&&(a.gallery.thumbnailPageIndex=a.gallery.thumbnailTotalPages);b.fn.mggallery.methods.swapThumbPage();b.fn.mggallery.methods.exchangeImage("div#thumbPage_"+a.gallery.thumbnailPageIndex+">li.thumbItem:first")});d.find("div"+a.thumbnailMetaDivClass).hide();d.children("a").children("img").css("opacity",0);c.show().find("div#thumbPage_"+a.gallery.thumbnailPageIndex).show();b("div"+a.mainImageDivContainerId+">div.next").animate({opacity:1}, a.animationSpeed).toggleClass("next current");d.each(function(){b.fn.mggallery.methods.fadeThumb(this,a.thumbDefaultOpacity)});0<a.slideShowInterval&&(a.slideShowAutoStart?(b.fn.mggallery.methods.startSlideShow(),b("div.slideShowControls span.play").hide().siblings("span.pause").show()):b("div.slideShowControls span.pause").hide().siblings("span.play").show(),b("div.slideShowControls").delegate("span","click",function(){var c=b(this).attr("class");"play"===c&&0===a.gallery.slideShowIntervalId?(b.fn.mggallery.methods.startSlideShow(), b(this).hide().siblings("span.pause").show()):"pause"===c&&0!==a.gallery.slideShowIntervalId&&(b.fn.mggallery.methods.stopSlideShow(),b(this).hide().siblings("span.play").show())}));a.enableBackButton&&a.enableDeepLinks&&b(window).bind("hashchange",function(){a.gallery.currentHash!==b.fn.mggallery.methods.hashImagePath(window.location.hash)&&(b.fn.mggallery.methods.exchangeImage('li[data-img_hash="'+b.fn.mggallery.methods.hashImagePath(window.location.hash)+'"]'),a.gallery.thumbnailPagePriorIndex!== a.gallery.thumbnailPageIndex&&b.fn.mggallery.methods.swapThumbPage())})}};b.fn.mggallery.defaults={thumbnailMetaDivClass:".thumbnailMeta",thumbnailCurrentItemClass:".currentThumb",mainImageDivContainerId:"#galleryMainContainer",currentImageDivClass:".currentImage",currentTitleDivClass:".currentTitle",currentMetaDivClass:".currentMeta",animationSpeed:1E3,exchangeType:"crossfade",thumbDefaultOpacity:0.5,thumbPageLimit:8,thumbNavFirst:" &#171; ",thumbNavFirstTitle:"First",thumbNavPrev:" &lt; ",thumbNavPrevTitle:"Previous", thumbNavNext:" &gt; ",thumbNavNextTitle:"Next",thumbNavLast:" &#187; ",thumbNavLastTitle:"Last",slideShowInterval:3E3,slideShowPlay:" Play ",slideShowPlayTitle:"Play Slideshow",slideShowPause:" Pause ",slideShowPauseTitle:"Pause Slideshow",slideShowAutoStart:!1,enableDeepLinks:!0,enableBackButton:!0}})(jQuery);