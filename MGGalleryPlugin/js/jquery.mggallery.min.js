/**
 *  jQuery MG Gallery Plugin
 *  https://github.com/wolfmoritz/mggallery
 *
 *  Version 1.3.3
 *
 * Copyright (c) 2011 - 2013 Wolfgang Moritz (http://www.wolfmoritz.com)
 * Licensed under the MIT License:
 *   http://www.opensource.org/licenses/MIT
 */

(function($){var config={};var $thumbs;$.fn.mggallery=function(options){$.extend(config,$.fn.mggallery.defaults,options);config.gallery={priorIndex:0,currentIndex:0,currentHash:"1",thumbnailCount:0,thumbnailPagePriorIndex:0,thumbnailPageIndex:0,thumbnailTotalPages:0,slideShowIntervalId:0};$thumbs=this.children("ul").children("li");config.gallery.thumbnailCount=$thumbs.size();if(config.gallery.thumbnailCount>0){$.fn.mggallery.methods.init(this);$.fn.mggallery.methods.preloadImages()}return this};$.fn.mggallery.methods=
{initGalleryContainer:function(){var currentHtml='<div class="next" style="opacity: 0;">';currentHtml+='<div class="'+config.currentImageDivClass.replace(".","")+'"><img src=""></div>';currentHtml+='<div class="'+config.currentTitleDivClass.replace(".","")+'"></div>';currentHtml+='<div class="'+config.currentMetaDivClass.replace(".","")+'"></div></div>';$(config.mainImageDivContainerId).html(currentHtml).prepend('<div class="slideShowControls">');if(config.slideShowInterval>0)$(".slideShowControls").html('<span class="pause" title="'+
config.slideShowPauseTitle+'">'+config.slideShowPause+'</span><span class="play" title="'+config.slideShowPlayTitle+'">'+config.slideShowPlay+"</span>")},loadImage:function(newImage){var $newImg=$(newImage);var newSrc=$newImg.children("a").attr("href");var newTitle=$newImg.children("a").attr("title");var newMeta=$newImg.children(config.thumbnailMetaDivClass).html();config.gallery.priorIndex=config.gallery.currentIndex;config.gallery.currentIndex=$newImg.data("img_id");config.gallery.thumbnailPagePriorIndex=
config.gallery.thumbnailPageIndex;config.gallery.thumbnailPageIndex=$newImg.data("thumbpage");if(config.enableDeepLinks&&newSrc!==undefined){config.gallery.currentHash=$newImg.data("img_hash");window.location.hash=$.fn.mggallery.methods.imagePath(newSrc)}$next=$(config.mainImageDivContainerId+">.next");$next.children(config.currentImageDivClass).children("img").load(function(){if(!$.trim(newTitle))$next.children(config.currentTitleDivClass).hide();else $next.children(config.currentTitleDivClass).html(newTitle).show();
if(!$.trim(newMeta))$next.children(config.currentMetaDivClass).hide();else $next.children(config.currentMetaDivClass).html(newMeta).show()}).attr("src",newSrc);$(config.thumbnailCurrentItemClass).removeClass(config.thumbnailCurrentItemClass.replace(".",""));$newImg.addClass(config.thumbnailCurrentItemClass.replace(".",""))},getNextImage:function(){var nextImageSelector;if(config.gallery.currentIndex+1<config.gallery.thumbnailCount)nextImageSelector='li[data-img_id="'+(config.gallery.currentIndex+
1)+'"]';else nextImageSelector='li[data-img_id="0"]';$.fn.mggallery.methods.exchangeImage(nextImageSelector)},fadeThumb:function(thumbItem,newOpacity){if($(thumbItem).hasClass(config.thumbnailCurrentItemClass.replace(".","")))newOpacity=1;$(thumbItem).children("a").children("img").stop().animate({opacity:newOpacity},config.animationSpeed)},exchangeImage:"",swapImage:function(newImage){$(config.mainImageDivContainerId).find(":animated").stop(true,true);$current=$(config.mainImageDivContainerId+">.current").toggleClass("current next");
$current.animate({opacity:0},config.animationSpeed,function(){$.fn.mggallery.methods.loadImage(newImage);$.fn.mggallery.methods.fadeThumb('li[data-img_id="'+config.gallery.priorIndex+'"]',config.thumbDefaultOpacity);if(config.gallery.thumbnailPagePriorIndex!==config.gallery.thumbnailPageIndex)$.fn.mggallery.methods.swapThumbPage();$(this).toggleClass("next current");$.fn.mggallery.methods.fadeThumb(newImage,1)});$current.animate({opacity:1},config.animationSpeed)},crossfadeImage:function(newImage){$(config.mainImageDivContainerId).find(":animated").stop(true,
true);$current=$(config.mainImageDivContainerId+">.current");$current.clone().css("opacity",0).toggleClass("current next").appendTo(config.mainImageDivContainerId);$.fn.mggallery.methods.loadImage(newImage);$.fn.mggallery.methods.fadeThumb('li[data-img_id="'+config.gallery.priorIndex+'"]',config.thumbDefaultOpacity);if(config.gallery.thumbnailPagePriorIndex!==config.gallery.thumbnailPageIndex)$.fn.mggallery.methods.swapThumbPage();$.fn.mggallery.methods.fadeThumb(newImage,1);$current.animate({opacity:0},
config.animationSpeed,function(){$(this).remove()});$(config.mainImageDivContainerId+">.next").animate({opacity:1},config.animationSpeed,function(){$(this).toggleClass("next current")})},imagePath:function(dirtyPath){return dirtyPath.replace(window.location.hostname,"").replace(window.location.protocol,"").replace("//","")},hashImagePath:function(dirtyPath){return $.fn.mggallery.methods.imagePath(dirtyPath).replace(/[^a-zA-Z0-9]/g,"")},preloadImages:function(){$thumbs.each(function(){$("<img/>")[0].src=
$(this).children("a").attr("href")})},initThumbPageControls:function(){var first='<span class="first" title="'+config.thumbNavFirstTitle+'">'+config.thumbNavFirst+"</span>";var prev='<span class="prev" title="'+config.thumbNavPrevTitle+'">'+config.thumbNavPrev+"</span>";var next='<span class="next" title="'+config.thumbNavNextTitle+'">'+config.thumbNavNext+"</span>";var last='<span class="last" title="'+config.thumbNavLastTitle+'">'+config.thumbNavLast+"</span>";var controls="";if(config.gallery.thumbnailPageIndex===
1)controls=next+last;else if(config.gallery.thumbnailPageIndex===config.gallery.thumbnailTotalPages)controls=first+prev;else controls=first+prev+next+last;$(".thumbPageControls").html(controls)},swapThumbPage:function(){$("#thumbPage_"+config.gallery.thumbnailPagePriorIndex).add(".thumbPageControls").fadeOut(config.animationSpeed,function(){$.fn.mggallery.methods.initThumbPageControls();$("#thumbPage_"+config.gallery.thumbnailPageIndex).add(".thumbPageControls").fadeIn(config.animationSpeed)})},startSlideShow:function(){if(config.gallery.slideShowIntervalId===
0)config.gallery.slideShowIntervalId=window.setInterval(function(){$.fn.mggallery.methods.getNextImage()},config.slideShowInterval)},stopSlideShow:function(){if(config.gallery.slideShowIntervalId!==0){window.clearInterval(config.gallery.slideShowIntervalId);config.gallery.slideShowIntervalId=0}},init:function($galleryThumbnails){$thumbs.each(function(i){$(this).addClass("thumbItem").attr("data-img_id",i).attr("data-img_hash",$.fn.mggallery.methods.hashImagePath($(this).children("a").attr("href")))});
$galleryThumbnails.prepend('<div class="thumbPageControls">');$galleryThumbnails.children("ul").append('<div class="clear">');$.fn.mggallery.methods.initGalleryContainer();var i=0;while(i<config.gallery.thumbnailCount){config.gallery.thumbnailTotalPages+=1;$thumbs.slice(i,i+config.thumbPageLimit).wrapAll('<div id="thumbPage_'+config.gallery.thumbnailTotalPages+'" class="centerThumbs" style="display:none;"/>').attr("data-thumbpage",config.gallery.thumbnailTotalPages);i+=config.thumbPageLimit}if($.fn.mggallery.methods.hashImagePath(window.location.hash).length>
0&&$.fn.mggallery.methods.hashImagePath(window.location.hash)!==undefined)$.fn.mggallery.methods.loadImage('li[data-img_hash="'+$.fn.mggallery.methods.hashImagePath(window.location.hash)+'"]');else $.fn.mggallery.methods.loadImage($thumbs[0]);if(config.exchangeType==="swap")$.fn.mggallery.methods.exchangeImage=$.fn.mggallery.methods.swapImage;else if(config.exchangeType==="crossfade")$.fn.mggallery.methods.exchangeImage=$.fn.mggallery.methods.crossfadeImage;if(config.gallery.thumbnailCount>config.thumbPageLimit)$.fn.mggallery.methods.initThumbPageControls();
$(config.mainImageDivContainerId).on("click","img",function(e){e.preventDefault();$.fn.mggallery.methods.getNextImage()});$galleryThumbnails.delegate(".thumbItem","click",function(e){e.preventDefault();if($(this).data("img_id")!==config.gallery.currentIndex){$(this).addClass(config.thumbnailCurrentItemClass.replace(".",""));$.fn.mggallery.methods.exchangeImage(this)}});$thumbs.each(function(){$(this).on({mouseenter:function(){$.fn.mggallery.methods.fadeThumb(this,1)},mouseleave:function(){$.fn.mggallery.methods.fadeThumb(this,
config.thumbDefaultOpacity)}})});$(".thumbPageControls").on("click","span",function(e){e.preventDefault();config.gallery.thumbnailPagePriorIndex=config.gallery.thumbnailPageIndex;var go=$(this).attr("class");if(go==="first")config.gallery.thumbnailPageIndex=1;else if(go==="prev")config.gallery.thumbnailPageIndex--;else if(go==="next")config.gallery.thumbnailPageIndex++;else if(go==="last")config.gallery.thumbnailPageIndex=config.gallery.thumbnailTotalPages;$.fn.mggallery.methods.swapThumbPage();$.fn.mggallery.methods.exchangeImage("#thumbPage_"+
config.gallery.thumbnailPageIndex+">.thumbItem:first")});$thumbs.find(config.thumbnailMetaDivClass).hide();$thumbs.children("a").children("img").css("opacity",0);$galleryThumbnails.show().find("#thumbPage_"+config.gallery.thumbnailPageIndex).show();$(config.mainImageDivContainerId+">.next").animate({opacity:1},config.animationSpeed).toggleClass("next current");$thumbs.each(function(i){$.fn.mggallery.methods.fadeThumb(this,config.thumbDefaultOpacity)});if(config.slideShowInterval>0){if(config.slideShowAutoStart){$.fn.mggallery.methods.startSlideShow();
$(".slideShowControls .play").hide().siblings(".pause").show()}else $(".slideShowControls .pause").hide().siblings(".play").show();$(".slideShowControls").delegate("span","click",function(e){var request=$(this).attr("class");if(request==="play"&&config.gallery.slideShowIntervalId===0){$.fn.mggallery.methods.startSlideShow();$(this).hide().siblings(".pause").show()}else if(request==="pause"&&config.gallery.slideShowIntervalId!==0){$.fn.mggallery.methods.stopSlideShow();$(this).hide().siblings(".play").show()}})}if(config.enableBackButton&&
config.enableDeepLinks)$(window).bind("hashchange",function(){if(config.gallery.currentHash!==$.fn.mggallery.methods.hashImagePath(window.location.hash)){$.fn.mggallery.methods.exchangeImage('li[data-img_hash="'+$.fn.mggallery.methods.hashImagePath(window.location.hash)+'"]');if(config.gallery.thumbnailPagePriorIndex!==config.gallery.thumbnailPageIndex)$.fn.mggallery.methods.swapThumbPage()}})}};$.fn.mggallery.defaults={thumbnailMetaDivClass:".thumbnailMeta",thumbnailCurrentItemClass:".currentThumb",
mainImageDivContainerId:"#galleryMainContainer",currentImageDivClass:".currentImage",currentTitleDivClass:".currentTitle",currentMetaDivClass:".currentMeta",animationSpeed:1E3,exchangeType:"crossfade",thumbDefaultOpacity:.5,thumbPageLimit:8,thumbNavFirst:" &#171; ",thumbNavFirstTitle:"First",thumbNavPrev:" &lt; ",thumbNavPrevTitle:"Previous",thumbNavNext:" &gt; ",thumbNavNextTitle:"Next",thumbNavLast:" &#187; ",thumbNavLastTitle:"Last",slideShowInterval:3E3,slideShowPlay:" Play ",slideShowPlayTitle:"Play Slideshow",
slideShowPause:" Pause ",slideShowPauseTitle:"Pause Slideshow",slideShowAutoStart:false,enableDeepLinks:true,enableBackButton:true}})(jQuery);